--------------
--REQUISICAO--
--------------

DROP TABLE portal_same.DOCUMENTO_REQUERENTE;

CREATE TABLE portal_same.DOCUMENTO_REQUERENTE(
  CD_DOCUMENTO_REQUERENTE          INT NOT NULL,
  CD_PACIENTE                      INT NOT NULL,
  PACIENTE_NOME                    VARCHAR(50),
  PACIENTE_RG                      VARCHAR(50),
  PACIENTE_CPF                     VARCHAR(50),
  PACIENTE_NASCIMENTO              TIMESTAMP,
  PERIODO_MINIMO                   TIMESTAMP,
  PERIODO_MAXIMO                   TIMESTAMP,
  TP_DISTANCIA                     VARCHAR(1) NOT NULL, -- S SIM | N NAO
  TP_REQUERENTE                    VARCHAR(50), -- A PROPRIO PACIENTE (A MINHA PESSOA) | R REPRESENTANTE LEGAL | T TUTOR/CURADOR | P PARENTE
  TP_PARENTE_MOTIVO                VARCHAR(1),  -- O OBITO | J DOCUMENTO JUDICIAL
  TP_PARENTE_PARENTESCO            VARCHAR(1),  -- C CONJUGE | D DESCENDENTES | A ASCENDENTES | I IRMAOS (2º GRAU) | 
                                                -- T SOBRINHOS/TIOS (3º GRAU) | Q SOBRINHOS-NETOS TIOS-AVOS PRIMOS (4º GRAU)
  REQUERENTE_NOME                  VARCHAR(50),
  REQUERENTE_RG                    VARCHAR(50),
  REQUERENTE_CPF                   VARCHAR(50),
  REQUERENTE_NASCIMENTO            TIMESTAMP,
  REQUERENTE_ESTADO_CIVIL          VARCHAR(50),
  REQUERENTE_PROFISSAO             VARCHAR(50),
  REQUERENTE_CEP                   VARCHAR(50),
  REQUERENTE_CIDADE                VARCHAR(50),
  REQUERENTE_ESTADO                VARCHAR(50),
  REQUERENTE_RUA                   VARCHAR(50),
  REQUERENTE_BAIRRO                VARCHAR(50),
  REQUERENTE_NUMERO                VARCHAR(50),
  REQUERENTE_COMPLEMENTO           VARCHAR(50),
  REQUERENTE_TEL_PRIMARIO          VARCHAR(50),
  REQUERENTE_TEL_SECUNDARIO        VARCHAR(50),
  REQUERENTE_TEL_TERCIARIO         VARCHAR(50),
  REQUERENTE_MOTIVO                VARCHAR(100),
  REQUERENTE_EMAIL                 VARCHAR(100),
  --ETAPA
  TP_ETAPA                         VARCHAR(1) NOT NULL, -- R RECEPCAO
                                                        -- A ADMINISTRAÇÃO(SECRETARIA) | I ADMINISTRAÇÃO(SECRETARIA) IMPUGNADO(NEGADO)
                                                        -- D DIRETORIA | N DIRETORIA NEGADO 
                                                        -- S SAME | C CONCLUIDO SAME    
  
  CD_USUARIO_CADASTRO              VARCHAR(50) NOT NULL,
  HR_CADASTRO                      TIMESTAMP NOT NULL, 
  CD_USUARIO_ULT_ALT               VARCHAR(50),
  HR_ULT_ALT                       TIMESTAMP 
);

DROP SEQUENCE portal_same.SEQ_DOCUMENTO_REQUERENTE;
CREATE SEQUENCE portal_same.SEQ_DOCUMENTO_REQUERENTE
START WITH 1000
INCREMENT BY 1
NOCACHE
NOCYCLE;

---------
--ANEXO--
---------
   
--ANEXO SAME
DROP TABLE portal_same.ARQUIVO_DOCUMENTO_SAME;

CREATE TABLE portal_same.ARQUIVO_DOCUMENTO_SAME
(
  CD_ARQUIVO_DOCUMENTO    NUMBER(10) NOT NULL,
  CD_DOCUMENTO_REQUERENTE INT NOT NULL,
  SN_ANEXO                VARCHAR(1) NOT NULL,   -- S SIM | N NAO
  TP_DOCUMENTO            VARCHAR2(2) NOT NULL , -- DS DOCUMENTO SAME
                                                 -- FR FOTO REQUERENTE | DC DOCUMENTO COM ASSINATURA | AO ATESTADO OBITO
                                                 -- DJ DOCUMENTO JUDICIAL | AE ASSINATURA EMAIL | CC CERTIDAO CASAMENTO
                                                 -- PL PROCURACAO LEGAL REPRESENTANTE | OT OUTROS
  LO_ARQUIVO_DOCUMENTO    BLOB NOT NULL,
  DS_NOME_ARQUIVO         VARCHAR2(40),
  TP_EXTENSAO             VARCHAR2(4),
  CD_USUARIO_CADASTRO     VARCHAR(20) NOT NULL,
  HR_CADASTRO             TIMESTAMP NOT NULL
);

ALTER TABLE portal_same.ARQUIVO_DOCUMENTO_SAME
ADD CONSTRAINT SAME_UNI_PK UNIQUE (CD_ARQUIVO_DOCUMENTO, TP_DOCUMENTO);

DROP SEQUENCE portal_same.SEQ_ARQUIVO_DOCUMENTO_SAME;

CREATE SEQUENCE portal_same.SEQ_ARQUIVO_DOCUMENTO_SAME
START WITH 1    
INCREMENT BY 1
NOCACHE
NOCYCLE;

-------------------------
--ASSINATURA REQUERENTE--
-------------------------

--ASSINATURA REQUERENTE SAME
DROP TABLE portal_same.ASSINATURA_PACIENTE;

CREATE TABLE portal_same.ASSINATURA_PACIENTE
(
  CD_DOCUMENTO_REQUERENTE    NUMBER(12) NOT NULL,
  ASSINATURA_PACIENTE        BLOB,
  DT_COLETA                  TIMESTAMP(6),
  CD_USUARIO_COLETA          VARCHAR2(30)
);

------------------
--JUSTIFICATIVAS--
------------------

--JUSTIFICATIVAS
DROP TABLE portal_same.JUSTIFICATIVA;

CREATE TABLE portal_same.JUSTIFICATIVA
(
  CD_DOCUMENTO_REQUERENTE    NUMBER(12) NOT NULL,
  TP_ETAPA                   VARCHAR(1) NOT NULL, 
                                                  -- I ADMINISTRAÇÃO(SECRETARIA) IMPUGNADO(NEGADO)
                                                  -- N DIRETORIA NEGADO
  DESC_JUSTIFICATIVA         VARCHAR(255),
  CD_USUARIO_CADASTRO        VARCHAR(50) NOT NULL,
  HR_CADASTRO                TIMESTAMP NOT NULL, 
  CD_USUARIO_ULT_ALT         VARCHAR(50),
  HR_ULT_ALT                 TIMESTAMP
);

-----------------------
--TP DOCUMENTO ANEXO --
-----------------------
   
--ANEXO SAME
DROP TABLE portal_same.TP_DOCUMENTO_ANEXO;

CREATE TABLE portal_same.TP_DOCUMENTO_ANEXO
(
  TP_DOCUMENTO            VARCHAR(2) NOT NULL,
  DS_DOCUMENTO            VARCHAR(20) NOT NULL,
  TP_OBRIGATORIO          VARCHAR(1) NOT NULL, -- S SIM | N NAO | O OPICIONAL
  TP_PARENTE_MOTIVO       VARCHAR(1) NULL, -- O OBITO | J JUDICIAL
  TP_PARENTE_PARENTESCO   VARCHAR(1) NULL, -- C CASAMENTO | D DESCENDENTE | A ASCENDENTE | I IRMAO | T 3 GRAU | Q 4 GRAU
  TP_DISTANCIA            VARCHAR(1) NOT NULL, -- S SIM | N NAO | A AMBOS
  TP_REQUERENTE           VARCHAR(1) NULL, -- A PROPRIO PACIENTE (A MINHA PESSOA) | R REPRESENTANTE LEGAL | T TUTOR/CURADOR | P PARENTE
  CD_USUARIO_CADASTRO     VARCHAR(50) NOT NULL,
  HR_CADASTRO             TIMESTAMP NOT NULL,
  CD_USUARIO_ULT_ALT      VARCHAR(50),
  HR_ULT_ALT              TIMESTAMP NOT NULL,   
    
  CONSTRAINT PK_TP_DOCUMENTO_ANEXO PRIMARY KEY (TP_DOCUMENTO)
  
);
